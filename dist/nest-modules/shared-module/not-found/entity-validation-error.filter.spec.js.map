{"version":3,"sources":["../../../../src/nest-modules/shared-module/not-found/entity-validation-error.filter.spec.ts"],"sourcesContent":["import { EntityValidationError } from '@core/shared/domain/validators/validation.error';\nimport { Controller, Get, INestApplication } from '@nestjs/common';\nimport { Test, TestingModule } from '@nestjs/testing';\nimport { EntityValidationErrorFilter } from './entity-validation-error.filter';\nimport request from 'supertest';\n\n@Controller('stub')\nclass StubController {\n  @Get()\n  index() {\n    throw new EntityValidationError([\n      'another error',\n      {\n        field1: ['field1 is required', 'error 2'],\n      },\n      {\n        field2: ['field2 is required'],\n      },\n    ]);\n  }\n}\n\ndescribe('EntityValidationErrorFilter Unit Tests ', () => {\n  let app: INestApplication;\n\n  beforeEach(async () => {\n    const moduleFixture: TestingModule = await Test.createTestingModule({\n      controllers: [StubController],\n    }).compile();\n    app = moduleFixture.createNestApplication();\n    app.useGlobalFilters(new EntityValidationErrorFilter());\n    await app.init();\n  });\n\n  it('should catch a EntityValidationError', () => {\n    return request(app.getHttpServer())\n      .get('/stub')\n      .expect(422)\n      .expect({\n        statusCode: 422,\n        error: 'Unprocessable Entity',\n        message: [\n          'another error',\n          'field1 is required',\n          'error 2',\n          'field2 is required',\n        ],\n      });\n  });\n});\n"],"names":["StubController","index","EntityValidationError","field1","field2","Get","Controller","describe","app","beforeEach","moduleFixture","Test","createTestingModule","controllers","compile","createNestApplication","useGlobalFilters","EntityValidationErrorFilter","init","it","request","getHttpServer","get","expect","statusCode","error","message"],"mappings":";;;;iCAAsC;wBACY;yBACd;6CACQ;kEACxB;;;;;;;;;;;;;;;AAEpB,IAAA,AACMA,iBADN,MACMA;IAEJC,QAAQ;QACN,MAAM,IAAIC,sCAAqB,CAAC;YAC9B;YACA;gBACEC,QAAQ;oBAAC;oBAAsB;iBAAU;YAC3C;YACA;gBACEC,QAAQ;oBAAC;iBAAqB;YAChC;SACD;IACH;AACF;;IAZGC,IAAAA,WAAG;;;;GADAL;AAAAA;IADLM,IAAAA,kBAAU,EAAC;GACNN;AAeNO,SAAS,2CAA2C;IAClD,IAAIC;IAEJC,WAAW;QACT,MAAMC,gBAA+B,MAAMC,aAAI,CAACC,mBAAmB,CAAC;YAClEC,aAAa;gBAACb;aAAe;QAC/B,GAAGc,OAAO;QACVN,MAAME,cAAcK,qBAAqB;QACzCP,IAAIQ,gBAAgB,CAAC,IAAIC,wDAA2B;QACpD,MAAMT,IAAIU,IAAI;IAChB;IAEAC,GAAG,wCAAwC;QACzC,OAAOC,IAAAA,kBAAO,EAACZ,IAAIa,aAAa,IAC7BC,GAAG,CAAC,SACJC,MAAM,CAAC,KACPA,MAAM,CAAC;YACNC,YAAY;YACZC,OAAO;YACPC,SAAS;gBACP;gBACA;gBACA;gBACA;aACD;QACH;IACJ;AACF"}